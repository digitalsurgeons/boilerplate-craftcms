!function(a){var b=Garnish.Base.extend({$groups:null,$selectedGroup:null,init:function(){this.$groups=a("#groups"),this.$selectedGroup=this.$groups.find("a.sel:first"),this.addListener(a("#newgroupbtn"),"activate","addNewGroup");var b=a("#groupsettingsbtn");if(b.length){var c=b.data("menubtn");c.settings.onOptionSelect=a.proxy(function(b){var c=a(b).data("action");switch(c){case"rename":this.renameSelectedGroup();break;case"delete":this.deleteSelectedGroup()}},this)}},addNewGroup:function(){var b=this.promptForGroupName("");if(b){var c={name:b};Craft.postActionRequest("fields/saveGroup",c,a.proxy(function(a,b){if("success"==b)if(a.success)location.href=Craft.getUrl("settings/fields/"+a.group.id);else if(a.errors){var c=this.flattenErrors(a.errors);alert(Craft.t("Could not create the group:")+"\n\n"+c.join("\n"))}else Craft.cp.displayError()},this))}},renameSelectedGroup:function(){var b=this.$selectedGroup.text(),c=this.promptForGroupName(b);if(c&&c!=b){var d={id:this.$selectedGroup.data("id"),name:c};Craft.postActionRequest("fields/saveGroup",d,a.proxy(function(a,b){if("success"==b)if(a.success)this.$selectedGroup.text(a.group.name),Craft.cp.displayNotice(Craft.t("Group renamed."));else if(a.errors){var c=this.flattenErrors(a.errors);alert(Craft.t("Could not rename the group:")+"\n\n"+c.join("\n"))}else Craft.cp.displayError()},this))}},promptForGroupName:function(a){return prompt(Craft.t("What do you want to name your group?"),a)},deleteSelectedGroup:function(){if(confirm(Craft.t("Are you sure you want to delete this group and all its fields?"))){var b={id:this.$selectedGroup.data("id")};Craft.postActionRequest("fields/deleteGroup",b,a.proxy(function(a,b){"success"==b&&(a.success?location.href=Craft.getUrl("settings/fields"):Craft.cp.displayError())},this))}},flattenErrors:function(a){var b=[];for(var c in a)b=b.concat(a[c]);return b}});Garnish.$doc.ready(function(){Craft.FieldsAdmin=new b})}(jQuery);
//# sourceMappingURL=fields.js.map